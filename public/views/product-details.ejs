<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>OCM || Product Details</title>
  <meta name="robots" content="noindex, follow" />
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <meta name="theme-style-mode" content="0"> <!-- 0 == light, 1 == dark -->

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="assets/images/favicon.png">
  <!-- CSS 
    ============================================ -->
  <link rel="stylesheet" href="assets/css/vendor/bootstrap.min.css">
  <link rel="stylesheet" href="assets/css/vendor/slick.css">
  <link rel="stylesheet" href="assets/css/vendor/slick-theme.css">
  <link rel="stylesheet" href="assets/css/vendor/nice-select.css">
  <link rel="stylesheet" href="assets/css/plugins/feature.css">
  <link rel="stylesheet" href="assets/css/plugins/jquery-ui.min.css">
  <%- include('functions.ejs')%>

  <!-- Style css -->
  <link rel="stylesheet" href="assets/css/style.css">
</head>

<body class="template-color-1">
  <!-- Preloader -->
  <div class="preloader">
    <div class='loader'>
      <div class='circle'></div>
      <div class='circle'></div>
      <div class='circle'></div>
      <div class='circle'></div>
      <div class='circle'></div>
    </div>
  </div>

  <!--PHP Header call-->
  <%- include('sections/header.ejs') -%>

  <!-- start page title area -->
  <div class="rn-breadcrumb-inner ptb--30">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-6 col-md-6 col-12">
          <h5 class="title text-center text-md-start">Product Details</h5>
        </div>
        <div class="col-lg-6 col-md-6 col-12">
          <ul class="breadcrumb-list">
            <li class="item"><a href="index.html">Home</a></li>
            <li class="separator"><i class="feather-chevron-right"></i></li>
            <li class="item current">Product Details</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <!-- end page title area -->

  <!-- start product details area -->
  <div class="product-details-area rn-section-gapTop">
    <div class="container">
      <div class="row g-5">
        <!-- product image area -->

        <div class="col-lg-7 col-md-12 col-sm-12">
          <div class="product-tab-wrapper rbt-sticky-top-adjust">
            <div class="pd-tab-inner">


              <div class="tab-content rn-pd-content" id="v-pills-tabContent">
                <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel" aria-labelledby="v-pills-home-tab">
                  <div class="rn-pd-thumbnail">
                    <img src="<%= nft.httpsImage%> " alt="Nft_Profile">
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
        <!-- product image area end -->

        <div class="col-lg-5 col-md-12 col-sm-12 mt_md--50 mt_sm--60">
          <div class="rn-pd-content-area">
            <div class="pd-title-area">
              <h4 class="title"><%=nft.uriMetadata.name%></h4>
              <div class="pd-react-area">

                <div class="heart-count <% if (login && nftLiked()) __append('liked')%>" <%if(login) {%>onclick="likeHandler('<%=nft.tokenID%>', this)" <%}%>>
                  <i data-feather="heart"></i>
                  <span><%=nft.likes.length%></span>
                </div>
                <div class="count">
                  <div class="share-btn share-btn-activation dropdown">
                    <button class="icon" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                      <svg viewBox="0 0 14 4" fill="none" width="16" height="16" class="sc-bdnxRM sc-hKFxyN hOiKLt">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M3.5 2C3.5 2.82843 2.82843 3.5 2 3.5C1.17157 3.5 0.5 2.82843 0.5 2C0.5 1.17157 1.17157 0.5 2 0.5C2.82843 0.5 3.5 1.17157 3.5 2ZM8.5 2C8.5 2.82843 7.82843 3.5 7 3.5C6.17157 3.5 5.5 2.82843 5.5 2C5.5 1.17157 6.17157 0.5 7 0.5C7.82843 0.5 8.5 1.17157 8.5 2ZM11.999 3.5C12.8274 3.5 13.499 2.82843 13.499 2C13.499 1.17157 12.8274 0.5 11.999 0.5C11.1706 0.5 10.499 1.17157 10.499 2C10.499 2.82843 11.1706 3.5 11.999 3.5Z" fill="currentColor"></path>
                      </svg>
                    </button>

                    <div class="share-btn-setting dropdown-menu dropdown-menu-end">
                      <!-- <button type="button" class="btn-setting-text share-text" data-bs-toggle="modal" data-bs-target="#shareModal">
                        Share
                      </button> -->
                      <button type="button" class="btn-setting-text report-text" data-bs-toggle="modal" data-bs-target="#reportModal">
                        Report
                      </button>
                      <input type="hidden" class="token-id" value="<%=nft.tokenID%>">
                    </div>

                  </div>
                </div>
              </div>
            </div>
            <span class="bid">Latest bid <span class="price"><%- nft.buyOffers[0] ? nft.buyOffers[0] + " XRP": "No bids"%></span></span>
            <h6 class="title-name">
              <%=nft.uriMetadata.collection.family%>
            </h6>
            <div class="catagory-collection">

              <div class="collection">
                <span>Collection</span>
                <div class="top-seller-inner-one">
                  <div class="top-seller-wrapper">
                    <div class="thumbnail">
                      <!-- a tag should link to collection of the respective NFT collection associated with that image -->
                      <a href="collection/({collection.family})"><img src="assets/images/client/client-2.png" alt="Nft_Profile"></a>
                    </div>
                    <div class="top-seller-content">
                      <a href="collection/({collection.family})">
                        <h6 class="name"><%=nft.uriMetadata.collection.name%></h6>
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="rn-bid-details">
              <div class="tab-wrapper-one">
                <nav class="tab-button-one">
                  <div class="nav nav-tabs" id="nav-tab" role="tablist">
                    <button class="nav-link" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home" aria-selected="false">Offers</button>
                    <button class="nav-link active" id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-profile" type="button" role="tab" aria-controls="nav-profile" aria-selected="true">Details</button>
                    <button class="nav-link" id="nav-contact-tab" data-bs-toggle="tab" data-bs-target="#nav-contact" type="button" role="tab" aria-controls="nav-contact" aria-selected="false">Purchase History</button>
                  </div>
                </nav>
                <div class="tab-content rn-bid-content" id="nav-tabContent">
                  <div class="tab-pane fade" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                    <h6 id="buyOffers" class="title name-title mr--10 transition">Buy Offers</h6>

                    <div id="buy-offer-container">
                      <div class="offers-slice">
                        <div class="offers-wrap">
                          <div class="offers-content">
                            <h5>Nothing To Show</h5>
                          </div>
                        </div>
                      </div>
                    </div>
                    <h6 id="buyOffers" class="title name-title mr--10 mt--20 transition">Sell Offers</h6>
                  </div>
                  <div class="tab-pane fade show active" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
                    <!-- single -->
                    <div class="rn-pd-bd-wrapper">
                      <div class="top-seller-inner-one">
                        <!-- <p class="disc">Lorem ipsum dolor, sit amet consectetur adipisicing
                                                  elit. Doloribus debitis nemo deserunt.</p> -->
                        <h6 class="name-title">

                          Owner
                        </h6>
                        <div class="top-seller-wrapper">

                          <div class="top-seller-content">
                            <!-- make link to issuer collection page on Marketplace if it exists -->
                            <div id="profile-thumbnail-container"></div>

                            <a href="" id="owner-name">
                              <div class="loader-content"></div>
                            </a>
                          </div>
                        </div>
                      </div>
                      <div class="top-seller-inner-one">
                        <!-- <p class="disc">Lorem ipsum dolor, sit amet consectetur adipisicing
                                                    elit. Doloribus debitis nemo deserunt.</p> -->
                        <h6 class="name-title">
                          Issuer
                        </h6>
                        <div class="top-seller-wrapper">

                          <div class="top-seller-content">
                            <!-- make link to issuer collection page on Marketplace if it exists -->
                            <a href="/profile?wallet=<%=nft.issuer%>">
                              <h6 class="name"><%=nft.issuer%></h6>
                            </a>
                          </div>
                        </div>
                        <!-- single -->
                        <div class="rn-pd-sm-property-wrapper">
                          <h6 class="pd-property-title">
                            Property
                          </h6>
                          <div class="property-wrapper" id="property">
                            <% nft.uriMetadata.attributes.forEach(function(res){%>
                            <!-- single property -->
                            <div class="pd-property-inner">
                              <span class="color-white type"><%=res.trait_type%></span>
                              <span class="color-white value"><%=res.value%></span>
                            </div>
                            <!-- single property End -->
                            <%}); %>

                          </div>
                        </div>
                        <!-- single -->
                        <div class="top-seller-content">
                          <h6 class="pd-property-title">
                            Description
                          </h6>
                          <div class="pd-property-inner">
                            <p style="font-size: 15px;"><%= nft.uriMetadata.description %></p>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- Previous Owners area -->
                    <div class="tab-pane fade" id="nav-contact" role="tabpanel" aria-labelledby="nav-contact-tab">
                      <!-- single creator -->
                      <div class="top-seller-inner-one">
                        <div class="top-seller-wrapper">
                          <a href="bithomp.com/explorer/[sale hash here]" target="_blank">
                            <div class="top-seller-content">
                              <!-- needs to be XRP value at time of sale -->
                              <span>250 XRP</span>
                              <span class="count-number">
                                <!-- DATE -->
                              </span>
                            </div>
                          </a>
                        </div>
                      </div>
                      <!-- single creator -->
                    </div>
                  </div>
                </div>
                <div class="place-bet-area">
                  <div class="rn-bet-create">
                    <div class="bid-list winning-bid">
                      <h6 class="title">Last Sale</h6>
                      <div class="top-seller-inner-one">
                        <div class="top-seller-wrapper">
                          <div class="thumbnail">
                            <a href="#"><img src="assets/images/client/client-7.png" alt="Nft_Profile"></a>
                          </div>
                          <div class="top-seller-content">
                            <span class="heighest-bid"><a href="https://xrpscan.com/account/'account address here'"></a></span>
                            <span class="count-number">
                              <%= nft.sellHistory[0] + " " + nft.sellHistory[0]%>
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>

                  </div>
                  <!-- <a class="btn btn-primary-alta mt--30" href="#">Place a Bid</a> -->
                  <div id="buy-offer-btn-container"></div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
    <!-- End product details area -->


    <!-- New items Start -->
    <div class="rn-new-items rn-section-gapTop">
      <div class="container">
        <div class="row mb--30 align-items-center">
          <div class="col-12">
            <h3 class="title mb--0" data-sal-delay="150" data-sal="slide-up" data-sal-duration="800">More Items</h3>
          </div>
        </div>
        <%- include('models/nft-rows.ejs', {nfts: nfts})  %>
      </div>
    </div>
    <!-- New items End -->
    <!-- Modal require -->
    <%- include('sections/popup-modal.ejs') -%>
    <%#if (!isOwner){%>
    <!-- PLACE BID MODAL -->
    <div class="rn-popup-modal placebid-modal-wrapper modal fade" id="placebidModal" tabindex="-1" aria-hidden="true" >
      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"><i data-feather="x"></i></button>
      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h3 class="modal-title">Place a bid</h3>
          </div>
          <div class="modal-body">
            <p>You are about to place a Bid</p>
            <div class="placebid-form-box">
              <h5 class="title">Your bid</h5>
              <div class="bid-content">
                <div class="bid-content-top">
                  <div class="bid-content-left" id="formData">
                    <input id="value" type="text" name="value">
                    <span>XRP</span>
                  </div>
                </div>

                <div class="bid-content-mid">
                  <div class="bid-content-left">
                    <span><strong>Your Balance</strong></span>
                    <!-- <span>Service fee</span> -->
                    <span>Total bid amount</span>
                  </div>
                  <div class="bid-content-right" onload="getCurrencyBalance()">
                    <span id="walletBalance" value='{"issuer": "XRP", "hex": "XRP", "token": "XRP"}'></span>
                    <!-- <span id="serviceFee">2 XRP</span> -->
                    <span id="sum">
                      <!-- 
                                        if(isset($_POST['submit'])){
                                            $sum=0;
                                            $one=$_POST['value'];
                                            $two=$_POST['serviceFee'];

                                            $sum=$one+$two;
                                            echo $sum;
                                        }                                        
                                         -->
                    </span>
                  </div>
                </div>
              </div>
              <div class="bit-continue-button">
                <button onclick="setBuyOfferBid('<%=nft.tokenID%>')" class="btn btn-primary w-100">Place a bid</button>
                <button type="button" class="btn btn-primary-alta mt--10" data-bs-dismiss="modal">Cancel</button>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
    <%#}%>

    <!-- PHP footer call -->
    <%- include('sections/popup-modal.ejs') -%>
    <%- include('sections/footer.ejs') -%>

    <!-- Start Top To Bottom Area  -->
    <div class="rn-progress-parent">
      <svg class="rn-back-circle svg-inner" width="100%" height="100%" viewBox="-1 -1 102 102">
        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98" />
      </svg>
    </div>
    <!-- End Top To Bottom Area  -->
    <!-- JS ============================================ -->
    <script src="assets/js/vendor/jquery.js"></script>
    <script src="assets/js/vendor/jquery.nice-select.min.js"></script>
    <script src="assets/js/vendor/jquery-ui.js"></script>
    <script src="assets/js/vendor/modernizer.min.js"></script>
    <script src="assets/js/vendor/feather.min.js"></script>
    <script src="assets/js/vendor/slick.min.js"></script>
    <script src="assets/js/vendor/bootstrap.min.js"></script>
    <script src="assets/js/vendor/sal.min.js"></script>
    <script src="assets/js/vendor/waypoint.js"></script>
    <script src="assets/js/vendor/wow.js"></script>
    <script src="assets/js/vendor/particles.js"></script>
    <script src="assets/js/vendor/jquery.style.swicher.js"></script>
    <script src="assets/js/vendor/js.cookie.js"></script>
    <script src="assets/js/vendor/count-down.js"></script>
    <script src="assets/js/vendor/counter-up.js"></script>
    <script src="assets/js/vendor/isotop.js"></script>
    <script src="assets/js/vendor/imageloaded.js"></script>
    <script src="assets/js/vendor/backtoTop.js"></script>
    <script src="assets/js/vendor/scrolltrigger.js"></script>
    <script src="assets/js/vendor/jquery.custom-file-input.js"></script>
    <script src="assets/js/vendor/savePopup.js"></script>
    <!-- main JS -->
    <script src="assets/js/main.js"></script>
    <script>
      $.post("/get-profile-info?id=<%-nft.tokenID%>", function(data) {
        $("#buy-offer-container").html(data[0]);
        $("#owner-name").html(`<h6 class = "name" style = "display: inline-block" >${data[2]}</h6>`);
        $("#owner-name").attr("href", `/profile?wallet=${data[2]}`);
        $("#profile-thumbnail-container").html(`<img src="${data[3]}" class="profile-thumbnail transition" onerror="this.src='assets/images/icons/unknown-user.png'">`)
        if (!data[4]) $("#buy-offer-btn-container").html('<button type="button" class="btn btn-primary-alta mt--30" data-bs-toggle="modal" data-bs-target="#placebidModal">Place an Offer</button>');
      })
      currNft = '<%=nft.tokenID%>';

      function getCurrencyBalance() {
              try {
                $("#walletBalance").load(`<%=url%>get-token-balance?issuer="XRP"&hex="XRP"&token="XRP"`);
              } catch (err) {
                console.error("Couldn't parse balance");
              }
            }
    </script>

</body>

</html>